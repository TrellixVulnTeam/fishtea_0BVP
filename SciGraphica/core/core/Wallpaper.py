#!/usr/bin/python# -*- coding: UTF-8 -*-import osimport pandas as pdimport numpy as npimport osfrom core.Store import Storeimport core.configdef getWallpaper(id):    return id in core.config.Gla_bizhi_account###数据类class Wallpaper(Store):    def __init__(self,file):        Store.__init__(self,files=file)    def get_wallpaper_data(self):        temp = self.read_semdata()        data = temp.loc[temp['推广账户'].apply(getWallpaper)]        col = ['渠道','日期','推广计划','展示次数','点击次数','总费用','实际消费']        wallpaperdata = pd.DataFrame(data,columns=col)        wallpaperdata['渠道'] = wallpaperdata['渠道'].astype('int64')        ##处理由于多帐户投放引起的BUG        duplicate_row = wallpaperdata.duplicated(subset=['渠道','日期','推广计划'],keep=False)        duplicate_data = wallpaperdata.loc[duplicate_row,:]        duplicate_data_sum = duplicate_data.groupby(by=['日期', '渠道','推广计划']).agg({'展示次数':sum,'点击次数':sum,'总费用':sum,'实际消费':sum}).reset_index(drop=True)        duplicate_data_one = duplicate_data.drop_duplicates(subset=['日期','渠道','推广计划'], keep="first").reset_index(drop=True)        duplicate_data_one['展示次数'] = duplicate_data_sum['展示次数']        duplicate_data_one['点击次数'] = duplicate_data_sum['点击次数']        duplicate_data_one['总费用'] = duplicate_data_sum['总费用']        duplicate_data_one['实际消费'] = duplicate_data_sum['实际消费']        ###取出未重复数据的行        no_duplicate_row = wallpaperdata.drop_duplicates(subset=['日期', '渠道','推广计划'], keep=False)        ####合并后取得最终数据        request = pd.concat([no_duplicate_row, duplicate_data_one])        return request    def wallpaper_admin_data(self):        wallpaperdata =  self.get_wallpaper_data()        wallpaperdata.to_csv('1.csv')